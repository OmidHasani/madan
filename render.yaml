services:
  - type: web
    name: pdf-chatbot
    env: python
    buildCommand: pip install -r requirements.txt && python initialize_db.py || echo "Database init skipped"
    startCommand: uvicorn api:app --host 0.0.0.0 --port $PORT
    envVars:
      - key: OPENAI_API_KEY
        sync: false
      - key: TAVILY_API_KEY
        sync: false
        optional: true
      - key: EMBEDDING_MODEL
        value: text-embedding-3-large
      - key: CHAT_MODEL
        value: gpt-4o
      - key: PDF_FILE_PATH
        value: shopmanual.pdf
      - key: VECTOR_DB_PATH
        value: vector_db
      - key: COLLECTION_NAME
        value: shop_manual
      - key: CHUNK_SIZE
        value: "2500"
      - key: CHUNK_OVERLAP
        value: "500"
      - key: HOST
        value: 0.0.0.0
      - key: PORT
        fromService:
          type: web
          name: pdf-chatbot
          property: port
